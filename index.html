<!DOCTYPE html><html lang="fa">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Happy Coin - Ù†Ø³Ø®Ù‡ 0.2.8</title>
  <style>
    body { background: #fffbe6; font-family: Tahoma, sans-serif; text-align: center; padding: 20px; transition: background .3s, color .3s; }
    body.dark { background: #121212; color: #eee; }
    #loginDiv, #gameDiv { max-width: 480px; margin: 20px auto; }
    input, button { font-size: 1rem; padding: 10px; margin: 5px; }
    input { width: 80%; border: 2px solid #c29200; border-radius: 5px; }
    button { background: #c29200; color: #fff; border: none; border-radius: 5px; cursor: pointer; }
    button:hover { background: #a17300; }
    #coin { width: 120px; height: 120px; cursor: pointer; transition: transform .2s; }
    #coin.clicked { transform: scale(1.1); }
    .section { border: 2px solid #c29200; padding: 10px; margin-top: 20px; border-radius: 6px; background: #fff8d6; }
    .floor-btn { margin: 5px; }
    #autoStatus { margin-top: 10px; color: #070; }
    #eventBtn { position: fixed; top: 20px; right: 20px; padding: 10px 20px; font-size: 14px; }
    #eventContainer { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.8); }
    #eventContent { background: #222; color: #fff; max-width: 600px; margin: 50px auto; padding: 20px; border-radius: 8px; text-align: center; }
    .windows { display: flex; justify-content: space-around; flex-wrap: wrap; margin-top: 20px; }
    .window { width: 100px; height: 140px; background: #c0d8f0; border: 3px solid #555; border-radius: 8px; position: relative; margin: 5px; }
    .shadow { position: absolute; top: 0; left: 0; width: 100%; height: 100%; border-radius: 8px; display: none; }
    .shadow.white { background: rgba(255,255,255,0.6); }
    .shadow.black { background: rgba(0,0,0,0.7); }
    .controls { position: absolute; bottom: 5px; width: 100%; display: flex; justify-content: space-around; }
    .controls button { font-size: .9rem; }
    #timer { font-size: 1.5rem; margin-top: 10px; }
  </style>
</head>
<body>
  <div id="loginDiv">
    <h2>Happy Coin ðŸŽ®</h2>
    <input id="usernameInput" placeholder="Ø§Ø³Ù… Ø®ÙˆØ¯ Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯" />
    <br><button id="loginBtn">ÙˆØ±ÙˆØ¯ / Ø«Ø¨Øªâ€ŒÙ†Ø§Ù…</button>
  </div>  <div id="gameDiv" style="display:none;">
    <h2>Ø³Ù„Ø§Ù… <span id="userDisplay"></span>!</h2>
    <img id="coin" src="https://i.postimg.cc/nrWTP5cb/coin-pixel.png" alt="Ø³Ú©Ù‡" />
    <div id="count">Ø³Ú©Ù‡: 0</div>
    <div id="blackCount">Ø³ÛŒØ§Ù‡: 0</div><div class="section">
  <button id="darkModeBtn">ØªØºÛŒÛŒØ± ØªÙ… (Ø±Ø§ÛŒÚ¯Ø§Ù†)</button>
  <button id="autoBtn">Auto-Click (Û´Ûµ Ø³ÛŒØ§Ù‡)</button>
  <div id="autoStatus"></div>
</div>

<div class="section">
  <h3>Ø®Ø±ÛŒØ¯ Ø·Ø¨Ù‚Ø§Øª (+Û±Ûµ Ø³ÛŒØ§Ù‡)</h3>
  <div id="floors"></div>
</div>

<div class="section">
  <button id="cheatBtn">Ú©Ø¯ ØªÙ‚Ù„Ø¨</button>
</div>

  </div><button id="eventBtn">Ø§ÛŒÙˆÙ†Øª (Û±Û±Û°Û° Ø³Ú©Ù‡)</button>

  <div id="eventContainer">
    <div id="eventContent">
      <h3>Ú†Ø§Ù„Ø´ Ù¾Ù†Ø¬Ø±Ù‡â€ŒÙ‡Ø§</h3>
      <p>Û¶Û° Ø«Ø§Ù†ÛŒÙ‡ Ø²Ù†Ø¯Ù‡ Ø¨Ù…ÙˆÙ†!</p>
      <div id="timer">Ø²Ù…Ø§Ù†: 60</div>
      <div class="windows" id="windowsContainer"></div>
      <button id="closeEventBtn">Ø®Ø±ÙˆØ¬</button>
    </div>
  </div><script>
  // Load/store data
  const saved = JSON.parse(localStorage.getItem('hc')||'{}');
  let currentUser;

  function save() { localStorage.setItem('hc', JSON.stringify(saved)); }

  // Login
  document.getElementById('loginBtn').onclick = () => {
    const name = document.getElementById('usernameInput').value.trim();
    if (name.length < 2) return alert('Ø§Ø³Ù… Ø¨Ø§ÛŒØ¯ Ø­Ø¯Ø§Ù‚Ù„ Û² Ø­Ø±Ù Ø¨Ø§Ø´Ø¯');
    if (!saved[name]) saved[name] = { coins:0, black:0, floors:0, dark:false, cheats:[] };
    currentUser = name;
    save();
    document.getElementById('loginDiv').style.display = 'none';
    document.getElementById('gameDiv').style.display = 'block';
    initGame();
  };

  function initGame() {
    document.getElementById('userDisplay').innerText = currentUser;
    document.getElementById('count').innerText = 'Ø³Ú©Ù‡: ' + saved[currentUser].coins;
    document.getElementById('blackCount').innerText = 'Ø³ÛŒØ§Ù‡: ' + saved[currentUser].black;
    document.getElementById('darkModeBtn').onclick = toggleDark;
    document.getElementById('coin').onclick = clickCoin;
    document.getElementById('autoBtn').onclick = buyAuto;
    renderFloors();
    document.getElementById('cheatBtn').onclick = applyCheat;
    document.getElementById('eventBtn').onclick = startEvent;
    document.getElementById('closeEventBtn').onclick = endEvent;
  }

  function clickCoin() {
    const u = saved[currentUser]; u.coins++; if (u.coins % 15 === 0) u.black++;
    save(); initGame();
    const el = document.getElementById('coin'); el.classList.add('clicked'); setTimeout(() => el.classList.remove('clicked'), 200);
  }

  function toggleDark() {
    const u = saved[currentUser]; u.dark = !u.dark; save(); document.body.classList.toggle('dark', u.dark);
  }

  // Auto-click
  let ai, at;
  function buyAuto() {
    const u = saved[currentUser]; if (u.black < 45) return alert('Ø³Ú©Ù‡ Ø³ÛŒØ§Ù‡ Ú©Ù… Ø§Ø³Øª');
    u.black -= 45; save(); initGame(); document.getElementById('autoStatus').innerText = 'Auto-Click ÙØ¹Ø§Ù„';
    clearInterval(ai); clearTimeout(at);
    ai = setInterval(() => { u.coins++; if (u.coins % 15 === 0) u.black++; save(); initGame(); }, 500);
    at = setTimeout(() => { clearInterval(ai); document.getElementById('autoStatus').innerText = 'Auto-Click Ù¾Ø§ÛŒØ§Ù†'; }, 5*60*1000);
  }

  // Floors
  function renderFloors() {
    const u = saved[currentUser]; const cont = document.getElementById('floors'); cont.innerHTML = '';
    for (let i=1; i<=5; i++) {
      const btn = document.createElement('button');
      btn.innerText = (i<=u.floors ? 'âœ… ' : 'ðŸª™ ') + `Ø·Ø¨Ù‚Ù‡ ${i} - ${i*1000} Ø³Ú©Ù‡`;
      if (i <= u.floors) btn.disabled = true;
      else btn.onclick = () => buyFloor(i);
      cont.appendChild(btn);
    }
  }
  function buyFloor(i) {
    const u = saved[currentUser]; const cost = i*1000;
    if (u.coins < cost) return alert('Ø³Ú©Ù‡ Ú©Ù… Ø§Ø³Øª');
    u.coins -= cost; u.black += 15; u.floors = i;
    save(); initGame();
    alert(`Ø·Ø¨Ù‚Ù‡ ${i} Ø®Ø±ÛŒØ¯Ø§Ø±ÛŒ Ø´Ø¯ Ùˆ Û±Ûµ Ø³Ú©Ù‡ Ø³ÛŒØ§Ù‡ Ø¯Ø±ÛŒØ§ÙØª Ú©Ø±Ø¯ÛŒ`);
  }

  // Cheat codes
  function applyCheat() {
    const code = prompt('Ú©Ø¯ ØªÙ‚Ù„Ø¨ Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯:'); const u = saved[currentUser];
    if (!code) return;
    if (u.cheats.includes(code)) return alert('Ø§ÛŒÙ† Ú©Ø¯ Ù‚Ø¨Ù„Ø§Ù‹ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø´Ø¯Ù‡');
    if (code === 'fff') u.coins += 600;
    else if (code === 'ff') u.black += 25;
    else if (code === 'cp9') { u.coins += 1000; u.black += 30; }
    else if (code === 'ty') { u.coins += 2000; u.black += 50; }
    else return alert('Ú©Ø¯ Ø§Ø´ØªØ¨Ø§Ù‡ Ø§Ø³Øª');
    u.cheats.push(code);
    save(); initGame(); alert('Ú©Ø¯ Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ø§Ø¹Ù…Ø§Ù„ Ø´Ø¯');
  }

  // Event game
  let timeLeft, eventInterval;
  function startEvent() {
    const u = saved[currentUser]; if (u.coins < 1100) return alert('Û±Û±Û°Û° Ø³Ú©Ù‡ Ù„Ø§Ø²Ù… Ø§Ø³Øª');
    u.coins -= 1100; save(); initGame();
    document.getElementById('eventContainer').style.display = 'block';
    timeLeft = 60; document.getElementById('timer').innerText = 'Ø²Ù…Ø§Ù†: ' + timeLeft;
    spawnWindows();
    eventInterval = setInterval(() => {
      timeLeft--;
      document.getElementById('timer').innerText = 'Ø²Ù…Ø§Ù†: ' + timeLeft;
      if (timeLeft <= 0) return finishEvent(true);
      spawnWindows();
    }, 3000);
  }
  function spawnWindows() {
    const container = document.getElementById('windowsContainer'); container.innerHTML = '';
    const idx = Math.floor(Math.random() * 5);
    const color = Math.random() < 0.5 ? 'white' : 'black';
    for (let i=0; i<5; i++) {
      const w = document.createElement('div'); w.className = 'window';
      const sh = document.createElement('div'); sh.className = 'shadow ' + color;
      w.appendChild(sh);
      const ctrl = document.createElement('div'); ctrl.className = 'controls';
      const bClose = document.createElement('button'); bClose.innerText = 'Ø¨Ø¨Ù†Ø¯';
      const bLight = document.createElement('button'); bLight.innerText = 'Ù†ÙˆØ±';
      bClose.onclick = () => handleAction(i, 'black', idx, color);
      bLight.onclick = () => handleAction(i, 'white', idx, color);
      ctrl.appendChild(bLight); ctrl.appendChild(bClose);
      w.appendChild(ctrl);
      container.appendChild(w);
    }
  }
  function handleAction(i, action, idx, color) {
    clearTimeout();
    if (i !== idx || action !== color) return finishEvent(false);
    // correct, nothing else, wait next interval
  }
  function finishEvent(win) {
    clearInterval(eventInterval);
    document.getElementById('eventContainer').style.display = 'none';
    if (win) {
      const u = saved[currentUser]; u.coins += 1000; u.black += 35; save(); initGame();
      alert('ðŸŽ‰ Ø¨Ø±Ù†Ø¯Ù‡ Ø´Ø¯ÛŒ! +1000 Ø³Ú©Ù‡ Ùˆ +35 Ø³ÛŒØ§Ù‡');
    } else alert('ðŸ“› Ø¨Ø§Ø®ØªÛŒ ÛŒØ§ Ø¯ÛŒØ± Ø´Ø¯ÛŒ');
  }
</script></body>
</html>
