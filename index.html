<!DOCTYPE html><html lang="fa">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Happy Coin - Ù†Ø³Ø®Ù‡ 0.1.5</title>
  <!-- Vazir Font for pixelated Persian text -->
  <link href="https://cdn.fontcdn.ir/Font/Persian/Vazir/Vazir.css" rel="stylesheet">
  <!-- CryptoJS library for AES encryption -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js"></script>
  <style>
    body { background: #fdf6e3; font-family: 'Vazir', monospace; text-align: center; padding: 20px; color: #333; transition: background 0.5s, color 0.5s; }
    body.dark { background: #121212; color: #eee; }
    #loginDiv, #gameDiv { max-width: 480px; margin: auto; }
    h1 { color: #c29200; text-shadow: 2px 2px 0 #7a5700; margin-bottom: 20px; }
    #coin { width: 150px; height: 150px; cursor: pointer; image-rendering: pixelated; border-radius: 50%; transition: transform 0.15s ease; }
    #coin.clicked { transform: scale(1.1) rotate(10deg); }
    #count, #blackCoins { font-size: 14px; margin: 10px 0; color: #7a5700; text-shadow: 1px 1px 0 #f0e68c; }
    button { background: #c29200; border: none; color: #fff; padding: 8px 16px; font-family: 'Vazir', monospace; font-size: 12px; margin: 5px; border-radius: 4px; cursor: pointer; box-shadow: 2px 2px 0 #7a5700; transition: background 0.3s; }
    button:hover { background: #a17300; }
    input[type="text"] { font-family: 'Vazir', monospace; font-size: 12px; padding: 6px; width: 70%; border: 2px solid #c29200; border-radius: 4px; background: #fffbe6; text-align: center; color: #7a5700; }
    .info { display: inline-block; width: 16px; height: 16px; background: #ffc107; color: #000; border-radius: 50%; font-size: 12px; line-height: 16px; text-align: center; cursor: pointer; margin-right: 5px; }
    .tooltip { display: none; position: absolute; background: #333; color: #fff; padding: 6px; border-radius: 4px; font-size: 12px; max-width: 200px; z-index: 100; }
    #shop, #dailyChallenge, #clickChallenge, #cheatDiv { margin-top: 20px; background: #fff8d6; border: 2px solid #c29200; border-radius: 6px; padding: 10px; }
    #autoStatus { font-size: 12px; color: #5a3e00; margin-top: 10px; }
    #trafficLight { width: 80px; height: 200px; background: #333; border-radius: 15px; margin: 10px auto; padding: 5px; display: none; }
    .light { width: 50px; height: 50px; border-radius: 50%; margin: 8px auto; background: #111; }
    .green { background: green; }
    .yellow { background: orange; }
    .red { background: red; }
    #clickBtn { display: none; margin-top: 10px; }
    #timer { font-size: 14px; margin-top: 10px; color: #d9534f; }
    #footer { margin-top: 30px; font-size: 10px; color: #7a5700; }
  </style>
</head>
<body>
  <!-- Login / Register -->
  <div id="loginDiv">
    <h1>Happy Coin ğŸ®</h1>
    <button onclick="login()">ÙˆØ±ÙˆØ¯ / Ø«Ø¨Øªâ€ŒÙ†Ø§Ù…</button>
  </div>  <!-- Main Game UI -->  <div id="gameDiv" style="display:none;">
    <h1>Ø³Ù„Ø§Ù… <span id="displayName"></span>!</h1>
    <!-- Coin Click -->
    <div>
      <span class="info" onmouseover="showTooltip(event,'Ú©Ù„ÛŒÚ© Ø±ÙˆÛŒ Ø³Ú©Ù‡ +1 Ø³Ú©Ù‡ Ø¹Ø§Ø¯ÛŒØ› Ù‡Ø± 15 Ú©Ù„ÛŒÚ© +1 Ø³Ú©Ù‡ Ø³ÛŒØ§Ù‡')" onmouseout="hideTooltip()">!</span>
      <img id="coin" src="https://i.postimg.cc/nrWTP5cb/coin-pixel.png" alt="Ø³Ú©Ù‡" onclick="addCoin()" />
    </div>
    <div id="count">ØªØ¹Ø¯Ø§Ø¯ Ø³Ú©Ù‡: 0</div>
    <div id="blackCoins">Ø³Ú©Ù‡ Ø³ÛŒØ§Ù‡: 0</div><!-- Shop: Dark Mode + Auto Click -->
<div id="shop">
  <h3>ğŸ›’ ÙØ±ÙˆØ´Ú¯Ø§Ù‡</h3>
  <span class="info" onmouseover="showTooltip(event,'ØªØºÛŒÛŒØ± ØªÙ… Ø±ÙˆØ´Ù†/ØªØ§Ø±ÛŒÚ© Ø±Ø§ÛŒÚ¯Ø§Ù†')" onmouseout="hideTooltip()">!</span>
  <button onclick="toggleDark()">ØªØºÛŒÛŒØ± ØªÙ…</button>
  <br>
  <span class="info" onmouseover="showTooltip(event,'Ø¬Ù…Ø¹â€ŒÚ©Ù†Ù†Ø¯Ù‡ Ø®ÙˆØ¯Ú©Ø§Ø±: 0.5 Ø«Ø§Ù†ÛŒÙ‡ ÛŒÚ© Ø³Ú©Ù‡ Ø¨Ø±Ø§ÛŒ 5 Ø¯Ù‚ÛŒÙ‚Ù‡ (45 Ø³Ú©Ù‡ Ø³ÛŒØ§Ù‡)')" onmouseout="hideTooltip()">!</span>
  <button onclick="buyAuto()">Ø®Ø±ÛŒØ¯ Auto-Click (45 Ø³Ú©Ù‡ Ø³ÛŒØ§Ù‡)</button>
  <div id="autoStatus"></div>
</div>

<!-- Daily Challenge: Floors -->
<div id="dailyChallenge">
  <h3>ğŸ  Ú†Ø§Ù„Ø´ Ø±ÙˆØ²Ø§Ù†Ù‡ - Ø·Ø¨Ù‚Ø§Øª</h3>
  <span class="info" onmouseover="showTooltip(event,'Ù‡Ø± Ø·Ø¨Ù‚Ù‡ +15 Ø³Ú©Ù‡ Ø³ÛŒØ§Ù‡ Ø¨Ø§ Ø®Ø±ÛŒØ¯')" onmouseout="hideTooltip()">!</span>
  <div id="floorsContainer"></div>
</div>

<!-- Click Challenge -->
<div id="clickChallenge">
  <h3>ğŸ¯ Ú†Ø§Ù„Ø´ Ú©Ù„ÛŒÚ©</h3>
  <span class="info" onmouseover="showTooltip(event,'Ù¾Ø±Ø¯Ø§Ø®Øª 1000 Ø³Ú©Ù‡ Ø¨Ø±Ø§ÛŒ Ú†Ø§Ù„Ø´ 30 Ø«Ø§Ù†ÛŒÙ‡â€ŒØ§ÛŒ Ú†Ø±Ø§Øº')" onmouseout="hideTooltip()">!</span>
  <button id="startBtn" onclick="startClickChallenge()">Ø´Ø±ÙˆØ¹ Ú†Ø§Ù„Ø´ (1000 Ø³Ú©Ù‡)</button>
  <div id="trafficLight">
    <div id="light3" class="light"></div>
    <div id="light2" class="light"></div>
    <div id="light1" class="light"></div>
  </div>
  <button id="clickBtn" onclick="handleClickChallenge()">Ú©Ù„ÛŒÚ© Ú©Ù†!</button>
  <div id="timer">Ø²Ù…Ø§Ù† Ø¨Ø§Ù‚ÛŒâ€ŒÙ…Ø§Ù†Ø¯Ù‡: 30</div>
</div>

<!-- Cheat Codes -->
<div id="cheatDiv">
  <h3>ğŸ’» Ú©Ø¯ ØªÙ‚Ù„Ø¨</h3>
  <span class="info" onmouseover="showTooltip(event,'Ú©Ø¯Ù‡Ø§ÛŒ fff, ff, cp9, ty Ù¾Ø´ØªÛŒØ¨Ø§Ù†ÛŒ Ù…ÛŒâ€ŒØ´ÙˆØ¯')" onmouseout="hideTooltip()">!</span>
  <button onclick="toggleCheat()">Ù†Ù…Ø§ÛŒØ´/Ù…Ø®ÙÛŒ Ú©Ø±Ø¯Ù†</button>
  <div id="cheatBox" style="display:none;">
    <input type="text" id="cheatCode" placeholder="Ú©Ø¯ Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯" />
    <button onclick="applyCheat()">Ø§Ø¹Ù…Ø§Ù„ Ú©Ø¯</button>
  </div>
</div>

<div id="footer">Ù†Ø³Ø®Ù‡: 0.1.5 | Ø³Ø§Ø®ØªÙ‡â€ŒØ´Ø¯Ù‡ ØªÙˆØ³Ø· Rob Lucci</div>
<div class="tooltip" id="tooltip"></div>

  </div>  <script>
    // AES Encryption Setup
    const ENCRYPTION_KEY = "RobLucciğŸ’SecretKey_2025";
    function encryptData(data) {
      return CryptoJS.AES.encrypt(JSON.stringify(data), ENCRYPTION_KEY).toString();
    }
    function decryptData(cipher) {
      try {
        const bytes = CryptoJS.AES.decrypt(cipher, ENCRYPTION_KEY);
        return JSON.parse(bytes.toString(CryptoJS.enc.Utf8));
      } catch {
        return {};
      }
    }

    // Load/Save from localStorage
    function saveData() {
      localStorage.setItem("happyCoinUsers", encryptData(usersData));
      localStorage.setItem("usedCheatCodes", encryptData(usedCheatCodes));
    }
    function loadData() {
      const u = localStorage.getItem("happyCoinUsers");
      const c = localStorage.getItem("usedCheatCodes");
      usersData = u ? decryptData(u) : {};
      usedCheatCodes = c ? decryptData(c) : [];
    }

    let currentUser = null;
    let usersData = {};
    let usedCheatCodes = [];
    loadData();

    // Coin click sound
    const clickSound = new Audio('https://actions.google.com/sounds/v1/cartoon/pop.ogg');
    clickSound.volume = 0.3;

    // Auto-click variables
    let autoInterval = null;
    let autoTimeout = null;

    // Challenge variables
    const maxFloor = 5;
    const floorBase = 1000;
    let lightState = 'red', challengeInterval = null, countdownInterval = null;
    let remaining = 30, earned = 0, inChallenge = false;

    // Tooltip functions
    function showTooltip(e, text) {
      const tip = document.getElementById('tooltip');
      tip.innerText = text;
      tip.style.left = e.pageX + 5 + 'px';
      tip.style.top = e.pageY + 5 + 'px';
      tip.style.display = 'block';
    }
    function hideTooltip() {
      document.getElementById('tooltip').style.display = 'none';
    }

    // Initialize UI on load
    window.onload = () => {
      const saved = localStorage.getItem('happyCoinCurrentUser');
      if (saved && usersData[saved]) {
        currentUser = saved;
        showGame();
      }
    };

    // User data init
    function initUser(name) {
      if (!usersData[name]) {
        usersData[name] = { coins: 0, blackCoins: 0, floorsBought: 0, darkMode: false };
        saveData();
      }
    }

    // Login/Register
    function login() {
      const name = prompt('Ø§Ø³Ù… Ø®ÙˆØ¯ Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯ (Ø­Ø¯Ø§Ù‚Ù„ Û² Ø­Ø±Ù):');
      if (!name || name.trim().length < 2) { alert('Ø§Ø³Ù… Ø¨Ø§ÛŒØ¯ Ø­Ø¯Ø§Ù‚Ù„ Û² Ø­Ø±Ù Ø¨Ø§Ø´Ø¯'); return; }
      currentUser = name.trim();
      initUser(currentUser);
      localStorage.setItem('happyCoinCurrentUser', currentUser);
      saveData();
      showGame();
    }
    function showGame() {
      document.getElementById('loginDiv').style.display = 'none';
      document.getElementById('gameDiv').style.display = 'block';
      updateUI();
    }

    // Update UI
    function updateUI() {
      const u = usersData[currentUser];
      document.getElementById('displayName').innerText = currentUser;
      document.getElementById('count').innerText = 'ØªØ¹Ø¯Ø§Ø¯ Ø³Ú©Ù‡: ' + u.coins;
      document.getElementById('blackCoins').innerText = 'Ø³Ú©Ù‡ Ø³ÛŒØ§Ù‡: ' + u.blackCoins;
      document.body.classList.toggle('dark', u.darkMode);
      renderFloors();
    }

    // Render floors
    function renderFloors() {
      const u = usersData[currentUser];
      let html = '';
      for (let i = 1; i <= maxFloor; i++) {
        html += `<button onclick="buyFloor(${i})" ${i <= u.floorsBought ? 'disabled' : ''}>${i <= u.floorsBought ? 'âœ…' : 'ğŸª™'} Ø·Ø¨Ù‚Ù‡ ${i} - ${floorBase * i}</button>`;
      }
      document.getElementById('floorsContainer').innerHTML = html;
    }
    function buyFloor(i) {
      const u = usersData[currentUser];
      const cost = floorBase * i;
      if (u.coins < cost) { alert('Ø³Ú©Ù‡ Ú©Ø§ÙÛŒ Ù†ÛŒØ³Øª'); return; }
      u.coins -= cost;
      u.blackCoins += 15;
      u.floorsBought = i;
      saveData(); updateUI();
      alert(`Ø·Ø¨Ù‚Ù‡ ${i} Ø®Ø±ÛŒØ¯ Ùˆ 15 Ø³Ú©Ù‡ Ø³ÛŒØ§Ù‡ Ø¯Ø±ÛŒØ§ÙØª Ø´Ø¯!`);
    }

    // Coin click
    function addCoin() {
      if (!currentUser) { login(); return; }
      const u = usersData[currentUser];
      u.coins++;
      if (u.coins % 15 === 0) u.blackCoins++;
      if (clickSound.paused) clickSound.play();
      saveData(); updateUI();
    }

    // Toggle dark mode (free)
    function toggleDark() {
      const u = usersData[currentUser];
      u.darkMode = !u.darkMode;
      saveData(); updateUI();
    }

    // Buy Auto-Click
    function buyAuto() {
      const u = usersData[currentUser];
      if (u.blackCoins < 45) { alert('Ø³Ú©Ù‡ Ø³ÛŒØ§Ù‡ Ú©Ø§ÙÛŒ Ù†ÛŒØ³Øª'); return; }
      u.blackCoins -= 45;
      saveData(); updateUI();
      document.getElementById('autoStatus').innerText = 'Auto-Click ÙØ¹Ø§Ù„ Ø´Ø¯';
      autoInterval = setInterval(() => {
        u.coins++; if (u.coins % 15 === 0) u.blackCoins++; saveData(); updateUI();
      }, 500);
      autoTimeout = setTimeout(() => {
        clearInterval(autoInterval);
        document.getElementById('autoStatus').innerText = 'Auto-Click Ù¾Ø§ÛŒØ§Ù† ÛŒØ§ÙØª';
      }, 5 * 60 * 1000);
    }

    // Click Challenge
    function startClickChallenge() {
      if (inChallenge) return;
      const u = usersData[currentUser];
      if (u.coins < 1000) { alert('Ø³Ú©Ù‡ Ú©Ø§ÙÛŒ Ù†ÛŒØ³Øª'); return; }
      u.coins -= 1000; saveData(); updateUI();
      inChallenge = true; earned = 0; remaining = 30;
      document.getElementById('trafficLight').style.display = 'block';
      document.getElementById('clickBtn').style.display = 'inline-block';
      document.getElementById('timer').innerText = 'Ø²Ù…Ø§Ù† Ø¨Ø§Ù‚ÛŒâ€ŒÙ…Ø§Ù†Ø¯Ù‡: ' + remaining;
      countdownInterval = setInterval(() => {
        remaining--;
        document.getElementById('timer').innerText = 'Ø²Ù…Ø§Ù† Ø¨Ø§Ù‚ÛŒâ€ŒÙ…Ø§Ù†Ø¯Ù‡: ' + remaining;
        if (remaining <= 0) endChallenge();
      }, 1000);
      runLight();
    }
    function runLight() {
      function cycle() {
        if (!inChallenge) return;
        document.querySelectorAll('.light').forEach(el => el.className = 'light');
        const r = Math.random();
        if (r < 0.4) { lightState = 'green'; document.getElementById('light3').classList.add('green'); }
        else if (r < 0.7) { lightState = 'yellow'; document.getElementById('light2').classList.add('yellow'); }
        else { lightState = 'red'; document.getElementById('light1').classList.add('red'); }
      }
      cycle(); challengeInterval = setInterval(cycle, 2000);
    }
    function handleClickChallenge() {
      if (!inChallenge) return;
      const u = usersData[currentUser];
      if (lightState === 'green') { u.blackCoins++; earned++; saveData(); updateUI(); }
      else if (lightState === 'red') { u.blackCoins = 0; saveData(); updateUI(); alert('Ø¨Ø§Ø®ØªÛŒ! Ø³Ú©Ù‡ Ø³ÛŒØ§Ù‡Øª Ø³ÙˆØ®Øª'); endChallenge(); }
    }
    function endChallenge() {
      inChallenge = false;
      clearInterval(challengeInterval); clearInterval(countdownInterval);
      document.getElementById('trafficLight').style.display = 'none';
      document.getElementById('clickBtn').style.display = 'none';
      document.getElementById('timer').innerText = '';
      alert('Ù¾Ø§ÛŒØ§Ù†! Ø³Ú©Ù‡ Ø³ÛŒØ§Ù‡ Ú©Ø³Ø¨ Ø´Ø¯Ù‡: ' + earned);
    }

    // Cheat Codes
    function toggleCheat() {
      const box = document.getElementById('cheatBox');
      box.style.display = box.style.display === 'none' ? 'block' : 'none';
    }
    function applyCheat() {
      const code = document.getElementById('cheatCode').value.trim().toLowerCase();
      if (!code) { alert('Ú©Ø¯ Ø®Ø§Ù„ÛŒ'); return; }
      if (usedCheatCodes.includes(currentUser + '_' + code)) { alert('Ø§ÛŒÙ† Ú©Ø¯ Ù‚Ø¨Ù„Ø§Ù‹ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø´Ø¯Ù‡'); return; }
      const u = usersData[currentUser];
      if (code === 'fff') { u.coins += 600; }
      else if (code === 'ff') { u.blackCoins += 25; }
      else if (code === 'cp9') { u.coins += 1000; u.blackCoins += 30; }
      else if (code === 'ty') { u.coins += 2000; u.blackCoins += 50; }
      else { alert('Ú©Ø¯ Ø§Ø´ØªØ¨Ø§Ù‡'); return; }
      usedCheatCodes.push(currentUser + '_' + code);
      saveData(); updateUI();
      alert('Ú©Ø¯ Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ø§Ø¹Ù…Ø§Ù„ Ø´Ø¯!');
      document.getElementById('cheatCode').value = '';
    }
  </script></body>
</html>
