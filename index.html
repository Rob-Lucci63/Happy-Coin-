<!DOCTYPE html><html lang="fa">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Happy Coin - Ù†Ø³Ø®Ù‡ 0.2.2</title>
  <!-- Vazir Font -->
  <link href="https://cdn.fontcdn.ir/Font/Persian/Vazir/Vazir.css" rel="stylesheet">
  <!-- CryptoJS Ø¨Ø±Ø§ÛŒ Ø±Ù…Ø²Ù†Ú¯Ø§Ø±ÛŒ AES -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js"></script>
  <style>
    body { background:#fffbe6; font-family:'Vazir',monospace; text-align:center; padding:20px; transition:background .5s,color .5s; }
    body.dark { background:#121212; color:#eee; }
    #loginDiv,#gameDiv{max-width:480px;margin:auto;}
    button{background:#c29200;border:none;color:#fff;padding:8px 16px;margin:5px;border-radius:4px;cursor:pointer;box-shadow:2px 2px 0 #7a5700;transition:background .3s;}
    button:hover{background:#a17300;}
    #coin{width:150px;height:150px;border-radius:50%;cursor:pointer;transition:transform .15s;}
    #coin.clicked{transform:scale(1.1) rotate(10deg);}
    #count,#blackCoins,#timer{font-size:14px;margin:10px 0;color:#7a5700;text-shadow:1px 1px 0 #f0e68c;}
    #shop,#dailyChallenge,#miniGameSection,#eventDiv,#cheatDiv{margin-top:20px;padding:10px;border:2px solid #c29200;border-radius:6px;background:#fff8d6;}
    .floor-btn{margin:3px;}
    .tooltip{display:none;position:absolute;background:#333;color:#fff;padding:6px;border-radius:4px;font-size:12px;max-width:200px;z-index:100;}
    #eventBtn{position:fixed;top:20px;right:20px;padding:10px 20px;font-size:14px;box-shadow:0 0 8px #fffbe6,0 0 16px #c29200,0 0 24px #7a5700;animation:neon 1.5s ease-in-out infinite alternate;}
    @keyframes neon{from{box-shadow:0 0 4px #fffbe6,0 0 8px #c29200;}to{box-shadow:0 0 12px #fff,0 0 24px #ff4500;}}
    #eventGame{display:none;position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.8);color:#fff;overflow:auto;}
    #eventGame .container{max-width:500px;margin:50px auto;padding:20px;background:#222;border-radius:8px;}
    .window-item{display:inline-block;width:80px;height:80px;margin:10px;background:#444;position:relative;}
    .window-item p{position:absolute;top:5px;left:5px;font-size:18px;}
  </style>
</head>
<body>
  <div id="loginDiv">
    <h2>Happy Coin ğŸ®</h2>
    <button onclick="login()">ÙˆØ±ÙˆØ¯ / Ø«Ø¨Øªâ€ŒÙ†Ø§Ù…</button>
  </div>
  <div id="gameDiv" style="display:none;">
    <h2>Ø³Ù„Ø§Ù… <span id="displayName"></span>!</h2>
    <img id="coin" src="https://i.postimg.cc/nrWTP5cb/coin-pixel.png" alt="Ø³Ú©Ù‡" onclick="addCoin()"/>
    <div id="count">Ø³Ú©Ù‡: 0</div>
    <div id="blackCoins">Ø³ÛŒØ§Ù‡: 0</div>
    <div id="shop"><button onclick="toggleDarkMode()">ØªØºÛŒÛŒØ± ØªÙ… (Ø±Ø§ÛŒÚ¯Ø§Ù†)</button></div>
    <div id="dailyChallenge"><h3>Ø®Ø±ÛŒØ¯ Ø·Ø¨Ù‚Ø§Øª</h3><div id="floorsContainer"></div></div>
    <div id="miniGameSection"><h3>Ø¨Ø§Ø²ÛŒâ€ŒÙ‡Ø§ÛŒ Ø·Ø¨Ù‚Ù‡â€ŒÙ‡Ø§</h3><div id="miniGameContainer"></div></div>
    <div id="cheatDiv"><button onclick="toggleCheatInput()">Ú©Ø¯ ØªÙ‚Ù„Ø¨</button><div id="cheatInputDiv" style="display:none;margin-top:10px;"><button onclick="applyCheat()">Ø§Ø¹Ù…Ø§Ù„ Ú©Ø¯</button></div></div>
    <div id="footer">Ù†Ø³Ø®Ù‡:0.2.2 | Rob Lucci</div>
  </div>
  <button id="eventBtn" onclick="openEvent()">Ø§ÛŒÙˆÙ†Øª</button>
  <div id="eventGame">
    <div class="container">
      <h3>Ú†Ø§Ù„Ø´ Ø§ÛŒÙˆÙ†Øª</h3>
      <p>Ø±Ø§Ù‡Ù†Ù…Ø§: Ûµ Ù¾Ù†Ø¬Ø±Ù‡. â—‰ = Ø¨Ø¨Ù†Ø¯ØŒ â—¯ = Ù†ÙˆØ±. Û¶Û° Ø«Ø§Ù†ÛŒÙ‡.</p>
      <div id="timer">Ø²Ù…Ø§Ù†: 60</div>
      <div id="windowsContainer"></div>
      <button onclick="closeEvent()">Ø®Ø±ÙˆØ¬</button>
    </div>
  </div>  <script>
    const SECRET_KEY = 'RobLucciğŸ”StrongKey2025';
    function encrypt(data) {
      return CryptoJS.AES.encrypt(JSON.stringify(data), SECRET_KEY).toString();
    }
    function decrypt(cipher) {
      try {
        const bytes = CryptoJS.AES.decrypt(cipher, SECRET_KEY);
        return JSON.parse(bytes.toString(CryptoJS.enc.Utf8));
      } catch {
        return {};
      }
    }

    // Load data
    let usersData = decrypt(localStorage.getItem('happyCoinUsers') || '');
    let usedCheatCodes = decrypt(localStorage.getItem('usedCheatCodes') || '');
    let currentUser;

    function saveData() {
      localStorage.setItem('happyCoinUsers', encrypt(usersData));
      localStorage.setItem('usedCheatCodes', encrypt(usedCheatCodes));
    }

    // User init & login
    function initUser(name) {
      if (!usersData[name]) {
        usersData[name] = { coins: 0, blackCoins: 0, floorsBought: 0, darkModeActive: false };
      }
      saveData();
    }
    function login() {
      let name = prompt('Ø§Ø³Ù… Ø®ÙˆØ¯ Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯ (Û² Ø­Ø±Ù ÛŒØ§ Ø¨ÛŒØ´ØªØ±):');
      if (!name || name.trim().length < 2) {
        alert('Ø§Ø³Ù… Ø¨Ø§ÛŒØ¯ Ø­Ø¯Ø§Ù‚Ù„ Û² Ø­Ø±Ù Ø¨Ø§Ø´Ø¯');
        return;
      }
      currentUser = name.trim();
      initUser(currentUser);
      localStorage.setItem('happyCoinCurrentUser', encrypt(currentUser));
      showGame();
    }
    window.onload = () => {
      try {
        const enc = localStorage.getItem('happyCoinCurrentUser');
        const saved = decrypt(enc);
        if (saved && usersData[saved]) {
          currentUser = saved;
          showGame();
        }
      } catch {}
    };

    function showGame() {
      document.getElementById('loginDiv').style.display = 'none';
      document.getElementById('gameDiv').style.display = 'block';
      updateUI();
      renderFloors();
      renderMiniGameButtons();
    }

    // UI update
    function updateUI() {
      let u = usersData[currentUser];
      document.getElementById('displayName').innerText = currentUser;
      document.getElementById('count').innerText = 'Ø³Ú©Ù‡: ' + u.coins;
      document.getElementById('blackCoins').innerText = 'Ø³ÛŒØ§Ù‡: ' + u.blackCoins;
      document.body.classList.toggle('dark', u.darkModeActive);
    }

    // Coin click
    function addCoin() {
      let u = usersData[currentUser];
      u.coins++;
      if (u.coins % 15 === 0) u.blackCoins++;
      saveData();
      updateUI();
      let c = document.getElementById('coin');
      c.classList.add('clicked');
      setTimeout(() => c.classList.remove('clicked'), 300);
    }

    // Dark mode toggle
    function toggleDarkMode() {
      let u = usersData[currentUser];
      u.darkModeActive = !u.darkModeActive;
      saveData();
      updateUI();
    }

    // Floors
    const maxFloor = 5;
    const floorBase = 1000;
    function renderFloors() {
      let u = usersData[currentUser];
      let html = '';
      for (let i = 1; i <= maxFloor; i++) {
        let cost = floorBase * i;
        let bought = i <= u.floorsBought;
        html += `<button ${bought ? 'disabled' : ''} onclick="buyFloor(${i})">${bought ? 'âœ…' : 'ğŸª™'} Ø·Ø¨Ù‚Ù‡ ${i} - ${cost}</button>`;
      }
      document.getElementById('floorsContainer').innerHTML = html;
    }
    function buyFloor(i) {
      let u = usersData[currentUser];
      let cost = floorBase * i;
      if (u.coins < cost) { alert('Ø³Ú©Ù‡ Ú©Ù…'); return; }
      u.coins -= cost;
      u.floorsBought = Math.max(u.floorsBought, i);
      saveData();
      updateUI();
      renderFloors();
      renderMiniGameButtons();
      alert(`Ø·Ø¨Ù‚Ù‡ ${i} Ø®Ø±ÛŒØ¯Ø§Ø±ÛŒ Ø´Ø¯!`);
    }

    // Mini-games for floors
    function renderMiniGameButtons() {
      let u = usersData[currentUser];
      let c = document.getElementById('miniGameContainer');
      c.innerHTML = '';
      for (let i = 1; i <= u.floorsBought; i++) {
        let btn = document.createElement('button');
        btn.innerText = 'Ø¨Ø§Ø²ÛŒ ' + i;
        btn.onclick = () => playFloorGame(i);
        c.appendChild(btn);
      }
    }
    function playFloorGame(f) {
      let win = confirm(`Ø¨Ø§Ø²ÛŒ ${f} Ø´Ø±ÙˆØ¹ Ø´Ø¯!
Ø¢ÛŒØ§ Ø¨Ø±Ø¯ÛŒØŸ`);
      if (win) {
        let u = usersData[currentUser];
        u.coins += 500;
        saveData();
        updateUI();
        alert('500 Ø³Ú©Ù‡ Ú¯Ø±ÙØªÛŒØ¯!');
      }
    }

    // Cheat codes
    function toggleCheatInput() {
      let d = document.getElementById('cheatInputDiv');
      d.style.display = d.style.display === 'none' ? 'block' : 'none';
    }
    function applyCheat() {
      let code = prompt('Ú©Ø¯ ØªÙ‚Ù„Ø¨:').toLowerCase();
      let u = usersData[currentUser];
      if (!code) return;
      if (usedCheatCodes.includes(currentUser + '_' + code)) return alert('Ø§ÛŒÙ† Ú©Ø¯ Ù‚Ø¨Ù„Ø§Ù‹ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø´Ø¯Ù‡');
      if (code === 'fff') u.coins += 600;
      else if (code === 'ff') u.blackCoins += 25;
      else if (code === 'cp9') { u.coins += 1000; u.blackCoins += 30; }
      else if (code === 'ty') { u.coins += 2000; u.blackCoins += 50; }
      else return alert('Ú©Ø¯ Ø§Ø´ØªØ¨Ø§Ù‡');
      usedCheatCodes.push(currentUser + '_' + code);
      saveData();
      updateUI();
      alert('Ú©Ø¯ Ø§Ø¹Ù…Ø§Ù„ Ø´Ø¯!');
    }

    // Event game
    let eventTime, eventInterval;
    function openEvent() {
      document.getElementById('eventGame').style.display = 'block';
      startEvent();
    }
    function closeEvent() {
      clearInterval(eventInterval);
      document.getElementById('eventGame').style.display = 'none';
    }
    function startEvent() {
      eventTime = 60;
      document.getElementById('timer').innerText = 'Ø²Ù…Ø§Ù†: ' + eventTime;
      eventInterval = setInterval(() => {
        if (eventTime <= 0) { endEvent(false); return; }
        document.getElementById('timer').innerText = 'Ø²Ù…Ø§Ù†: ' + eventTime;
        eventTime--;
        spawnWindow();
      }, 3000);
    }
    function spawnWindow() {
      let idx = Math.floor(Math.random() * 5);
      let type = Math.random() < 0.5 ? 'â—¯' : 'â—‰';
      alert(`Ù¾Ù†Ø¬Ø±Ù‡ ${idx + 1}: ${type}`);
    }
    function endEvent(win) {
      clearInterval(eventInterval);
      closeEvent();
      if (win) {
        let u = usersData[currentUser];
        u.coins += 1000; u.blackCoins += 35;
        saveData();
        updateUI();
        alert('1000 Ø³Ú©Ù‡ Ùˆ 35 Ø³ÛŒØ§Ù‡!');
      } else alert('Ø¨Ø§Ø®Øª ÛŒØ§ Ø²Ù…Ø§Ù† ØªÙ…ÙˆÙ… Ø´Ø¯');
    }
  </script></body>
</html>
