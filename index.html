<!DOCTYPE html><html lang="fa">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Happy Coin - چالش روزانه با ۵ طبقه</title>
  <style>
    body { background: #fffbe6; font-family: Tahoma, sans-serif; text-align: center; padding: 20px; color: #333; }
    body.dark { background-color: #121212; color: #eee; }
    #loginDiv, #gameDiv { max-width:480px; margin:auto; }
    input[type="text"] { font-size:1.1rem; padding:10px; width:90%; margin-bottom:15px; border-radius:5px; border:1px solid #ccc; }
    button { font-size:1rem; padding:8px 20px; background:#c29200; border:none; color:#fff; border-radius:5px; cursor:pointer; margin:5px; }
    button:hover { background:#a17300; }
    #coin { width:150px; cursor:pointer; user-select:none; margin-top:10px; transition:transform .2s; }
    #coin.clicked { animation:bounce .3s; }
    @keyframes bounce {0%{transform:scale(1) rotate(0deg);}30%{transform:scale(1.2) translateY(-20px) rotate(20deg);}60%{transform:scale(1.1) translateY(10px) rotate(-20deg);}100%{transform:scale(1) rotate(0deg);} }
    #count,#blackCoins { font-size:1.4rem; margin-top:15px; font-weight:bold; }
    #leaderboard { margin-top:25px; text-align:right; }
    table{width:100%;border-collapse:collapse;font-size:0.9rem;}th,td{border:1px solid #c29200;padding:6px;}th{background:#f3d87f;}
    #shop,#dailyChallenge{margin-top:30px;border-top:2px solid #c29200;padding-top:15px;}
    .floor-btn{margin:5px;}
    .mini-game{margin-top:20px;border:1px solid #c29200;padding:15px;border-radius:8px;background:#fff8d6;}
    #cheatDiv{margin-top:20px;}#footer{margin-top:40px;font-size:.9rem;color:#666;}
    .hidden{display:none;}#catchAppleGame{position:relative;width:300px;height:300px;margin:20px auto;background:#a0d8f0;border-radius:12px;overflow:hidden;}#apple{position:absolute;top:0;left:130px;width:30px;height:30px;background:red;border-radius:50%;cursor:pointer;}#basket{position:absolute;bottom:10px;left:120px;width:60px;height:30px;background:brown;border-radius:15px 15px 0 0;}
  </style>
</head>
<body>
<div id="loginDiv">
  <h2>خوش اومدی! اسم‌تو وارد کن 👇</h2>
  <input type="text" id="username" placeholder="اسم کاربر" />
  <br><button onclick="login()">ورود</button>
</div><div id="gameDiv" style="display:none;">
  <h2>سلام <span id="displayName"></span>!</h2>
  <img id="coin" src="https://i.postimg.cc/nrWTP5cb/coin-pixel.png" alt="سکه" onclick="addCoin()" />
  <div id="count">تعداد سکه: 0</div>
  <div id="blackCoins">سکه سیاه: 0</div>  <div id="leaderboard">
    <h3>🏆 جدول رتبه‌بندی</h3>
    <table><thead><tr><th>رتبه</th><th>اسم</th><th>سکه</th></tr></thead>
    <tbody id="leaderboardBody"></tbody></table>
  </div>  <div id="shop">
    <h3>🛒 فروشگاه</h3>
    <p>تم دارک مود: ۳۴ سکه سیاه</p>
    <button onclick="buyDarkMode()">خرید دارک مود</button>
    <button onclick="toggleDarkMode()">تغییر تم</button>
  </div>  <div id="dailyChallenge">
    <h3>🏠 چالش روزانه - خرید طبقات</h3>
    <div id="floorsContainer"></div>
    <div id="miniGameContainer"></div>
  </div>  <div id="cheatDiv">
    <button onclick="toggleCheatInput()">کد تقلب</button>
    <div id="cheatInputDiv" style="display:none; margin-top:10px;">
      <input id="cheatCode" placeholder="کد رو وارد کن" />
      <button onclick="applyCheat()">اعمال کد</button>
    </div>
  </div>
  <div id="footer">نسخه:0.0.3 | توسط Rob Lucci</div>
</div><script>
let currentUser=null,usersData=JSON.parse(localStorage.getItem("happyCoinUsers")||"{}"),usedCheatCodes=JSON.parse(localStorage.getItem("usedCheatCodes")||"[]");
const maxFloor=5;const floorBase=1000;
function initUserData(n){if(!usersData[n]){usersData[n]={coins:0,blackCoins:0,floorsBought:0,darkModeBought:false,darkModeActive:false,token:'_'+Math.random().toString(36).substr(2,9)};saveData()}}
function login(){let n=document.getElementById("username").value.trim();if(n.length<2)return alert("اسم باید حداقل ۲ حرف باشد");currentUser=n;initUserData(n);localStorage.setItem("happyCoinCurrentUser",n);loginFinish()}
function loginFinish(){document.getElementById("loginDiv").style.display="none";document.getElementById("gameDiv").style.display="block";updateUI();renderFloors()}
function saveData(){localStorage.setItem("happyCoinUsers",JSON.stringify(usersData));localStorage.setItem("usedCheatCodes",JSON.stringify(usedCheatCodes))}
function updateUI(){document.getElementById("displayName").innerText=currentUser;updateCoinCount();updateBlackCoins();renderLeaderboard();updateDarkMode();showShop()}
function updateCoinCount(){document.getElementById("count").innerText="تعداد سکه: "+usersData[currentUser].coins}
function updateBlackCoins(){document.getElementById("blackCoins").innerText="سکه سیاه: "+usersData[currentUser].blackCoins}
function addCoin(){let u=usersData[currentUser];u.coins++;if(u.coins%15==0)u.blackCoins++;saveData();updateUI();document.getElementById("coin").classList.add("clicked");setTimeout(()=>document.getElementById("coin").classList.remove("clicked"),300)}
function renderLeaderboard(){let t="",arr=Object.entries(usersData).sort((a,b)=>b[1].coins-a[1].coins);arr.forEach((e,i)=>t+=`<tr><td>${i+1}</td><td>${e[0]}</td><td>${e[1].coins}</td></tr>`);document.getElementById("leaderboardBody").innerHTML=t}
function buyDarkMode(){let u=usersData[currentUser];if(u.blackCoins>=34){u.blackCoins-=34;u.darkModeBought=true;u.darkModeActive=true;saveData();updateUI();updateDarkMode();alert("دارک مود فعال شد")}else alert("سکه سیاه کافی نیست")}
function toggleDarkMode(){let u=usersData[currentUser];if(u.darkModeBought){u.darkModeActive=!u.darkModeActive;saveData();updateDarkMode()}else alert("ابتدا بخر!")}
function updateDarkMode(){document.body.classList.toggle("dark",usersData[currentUser].darkModeActive)}
function showShop(){document.getElementById("shop").style.display="block"}
function renderFloors(){let c="",u=usersData[currentUser];for(let i=1;i<=maxFloor;i++){let cost=floorBase*i;let bought=i<=u.floorsBought; c+=`<button class='floor-btn' onclick='buyFloor(${i})' ${bought?"disabled":""}>${bought?"✅":"🪙"}طبقه ${i} - ${cost} سکه</button>`}document.getElementById("floorsContainer").innerHTML=c}
function buyFloor(i){let u=usersData[currentUser],cost=floorBase*i; if(u.coins>=cost){u.coins-=cost;u.floorsBought=i;saveData();updateUI();renderFloors();alert(`طبقه ${i} باز شد!`)}else alert("سکه کافی نیست")}
function toggleCheatInput(){let d=document.getElementById("cheatInputDiv");d.style.display=d.style.display=="none"?"block":"none"}
function applyCheat(){let code=document.getElementById("cheatCode").value.trim().toLowerCase();if(!code)return alert("کد خالی است");if(usedCheatCodes.includes(currentUser+"_"+code))return alert("استفاده شده");let u=usersData[currentUser];if(code=="fff")u.coins+=600;else if(code=="ff")u.blackCoins+=25;else return alert("کد اشتباه");usedCheatCodes.push(currentUser+"_"+code);saveData();updateUI();alert("کد اعمال شد!")}
window.onload=()=>{let s=localStorage.getItem("happyCoinCurrentUser");if(s&&usersData[s]){currentUser=s;loginFinish()}}
</script></body>
</html>
